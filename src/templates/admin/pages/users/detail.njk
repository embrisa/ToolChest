{% extends "layouts/admin-layout.njk" %}

{% block content %}
<div class="p-6">
    <!-- Header Section -->
    <div class="mb-8">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-sand-100 mb-2">{{ user.username }}</h1>
                <p class="text-neutral-400">User details and account information</p>
            </div>
            <div class="flex items-center space-x-3">
                <a href="/admin/users" 
                   class="bg-neutral-600 hover:bg-neutral-700 text-white px-4 py-2 rounded-lg transition-colors duration-200 font-medium flex items-center">
                    <i class="fas fa-arrow-left mr-2"></i>Back to Users
                </a>
                {% if canEdit %}
                <a href="/admin/users/{{ user.id }}/edit" 
                   class="bg-sunset-500 hover:bg-sunset-600 text-white px-4 py-2 rounded-lg transition-colors duration-200 font-medium flex items-center">
                    <i class="fas fa-edit mr-2"></i>Edit User
                </a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- User Information Cards -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
        <!-- Basic Information -->
        <div class="content-container p-6">
            <h3 class="text-lg font-medium text-sand-100 mb-4 flex items-center">
                <i class="fas fa-user mr-2 text-ocean-400"></i>Basic Information
            </h3>
            <div class="space-y-3">
                <div>
                    <span class="text-neutral-400 text-sm">Username:</span>
                    <div class="text-sand-100 font-medium">{{ user.username }}</div>
                </div>
                <div>
                    <span class="text-neutral-400 text-sm">Email:</span>
                    <div class="text-sand-100">{{ user.email }}</div>
                </div>
                <div>
                    <span class="text-neutral-400 text-sm">User ID:</span>
                    <div class="text-sand-100 font-mono text-sm">{{ user.id }}</div>
                </div>
            </div>
        </div>

        <!-- Role & Status -->
        <div class="content-container p-6">
            <h3 class="text-lg font-medium text-sand-100 mb-4 flex items-center">
                <i class="fas fa-shield-alt mr-2 text-ocean-400"></i>Role & Status
            </h3>
            <div class="space-y-3">
                <div>
                    <span class="text-neutral-400 text-sm">Role:</span>
                    <div class="mt-1">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                            {% if user.role == 'SUPER_ADMIN' %}bg-sunset-500/20 text-sunset-300
                            {% elif user.role == 'ADMIN' %}bg-blue-500/20 text-blue-300
                            {% else %}bg-gray-500/20 text-gray-300{% endif %}">
                            {% if user.role == 'SUPER_ADMIN' %}<i class="fas fa-crown mr-1"></i>{% endif %}
                            {{ user.role.replace('_', ' ') | title }}
                        </span>
                    </div>
                </div>
                <div>
                    <span class="text-neutral-400 text-sm">Status:</span>
                    <div class="mt-1">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                            {% if user.isActive %}bg-green-500/20 text-green-300{% else %}bg-red-500/20 text-red-300{% endif %}">
                            <i class="fas fa-circle mr-1 text-xs"></i>
                            {% if user.isActive %}Active{% else %}Inactive{% endif %}
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Activity Information -->
        <div class="content-container p-6">
            <h3 class="text-lg font-medium text-sand-100 mb-4 flex items-center">
                <i class="fas fa-clock mr-2 text-ocean-400"></i>Activity
            </h3>
            <div class="space-y-3">
                <div>
                    <span class="text-neutral-400 text-sm">Last Login:</span>
                    <div class="text-sand-100">
                        {% if user.lastLoginAt %}
                            {{ user.lastLoginAt | date('MMM d, yyyy') }}
                            <div class="text-xs text-neutral-500">{{ user.lastLoginAt | date('HH:mm') }}</div>
                        {% else %}
                            <span class="text-neutral-500">Never</span>
                        {% endif %}
                    </div>
                </div>
                <div>
                    <span class="text-neutral-400 text-sm">Account Created:</span>
                    <div class="text-sand-100">
                        {{ user.createdAt | date('MMM d, yyyy') }}
                        <div class="text-xs text-neutral-500">{{ user.createdAt | date('HH:mm') }}</div>
                    </div>
                </div>
                <div>
                    <span class="text-neutral-400 text-sm">Last Updated:</span>
                    <div class="text-sand-100">
                        {{ user.updatedAt | date('MMM d, yyyy') }}
                        <div class="text-xs text-neutral-500">{{ user.updatedAt | date('HH:mm') }}</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Role Permissions -->
    <div class="content-container p-6 mb-6">
        <h3 class="text-lg font-medium text-sand-100 mb-4 flex items-center">
            <i class="fas fa-key mr-2 text-ocean-400"></i>Role Permissions
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            {% if user.role == 'SUPER_ADMIN' %}
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">User Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Tools Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Tags Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Relationships Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Analytics Access</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">System Configuration</span>
            </div>
            {% elif user.role == 'ADMIN' %}
            <div class="flex items-center p-3 bg-red-500/10 border border-red-500/20 rounded-lg">
                <i class="fas fa-times text-red-400 mr-3"></i>
                <span class="text-red-300">User Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Tools Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Tags Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Relationships Management</span>
            </div>
            <div class="flex items-center p-3 bg-green-500/10 border border-green-500/20 rounded-lg">
                <i class="fas fa-check text-green-400 mr-3"></i>
                <span class="text-green-300">Analytics Access</span>
            </div>
            <div class="flex items-center p-3 bg-red-500/10 border border-red-500/20 rounded-lg">
                <i class="fas fa-times text-red-400 mr-3"></i>
                <span class="text-red-300">System Configuration</span>
            </div>
            {% else %}
            <div class="flex items-center p-3 bg-red-500/10 border border-red-500/20 rounded-lg">
                <i class="fas fa-times text-red-400 mr-3"></i>
                <span class="text-red-300">User Management</span>
            </div>
            <div class="flex items-center p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg">
                <i class="fas fa-eye text-yellow-400 mr-3"></i>
                <span class="text-yellow-300">Tools Viewing</span>
            </div>
            <div class="flex items-center p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg">
                <i class="fas fa-eye text-yellow-400 mr-3"></i>
                <span class="text-yellow-300">Tags Viewing</span>
            </div>
            <div class="flex items-center p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg">
                <i class="fas fa-eye text-yellow-400 mr-3"></i>
                <span class="text-yellow-300">Relationships Viewing</span>
            </div>
            <div class="flex items-center p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg">
                <i class="fas fa-eye text-yellow-400 mr-3"></i>
                <span class="text-yellow-300">Analytics Viewing</span>
            </div>
            <div class="flex items-center p-3 bg-red-500/10 border border-red-500/20 rounded-lg">
                <i class="fas fa-times text-red-400 mr-3"></i>
                <span class="text-red-300">System Configuration</span>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Actions -->
    {% if canEdit and user.id != adminUser.id %}
    <div class="content-container p-6">
        <h3 class="text-lg font-medium text-sand-100 mb-4 flex items-center">
            <i class="fas fa-cogs mr-2 text-ocean-400"></i>Actions
        </h3>
        <div class="flex flex-wrap gap-3">
            <button hx-post="/admin/users/{{ user.id }}/toggle"
                    hx-confirm="Are you sure you want to {% if user.isActive %}deactivate{% else %}activate{% endif %} this user?"
                    class="{% if user.isActive %}bg-red-600 hover:bg-red-700{% else %}bg-green-600 hover:bg-green-700{% endif %} text-white px-4 py-2 rounded-lg transition-colors duration-200 font-medium flex items-center">
                <i class="fas fa-{% if user.isActive %}user-times{% else %}user-check{% endif %} mr-2"></i>
                {% if user.isActive %}Deactivate User{% else %}Activate User{% endif %}
            </button>
            
            <button hx-delete="/admin/users/{{ user.id }}"
                    hx-confirm="Are you sure you want to delete this user? This action cannot be undone."
                    class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors duration-200 font-medium flex items-center">
                <i class="fas fa-trash mr-2"></i>Delete User
            </button>
        </div>
    </div>
    {% endif %}
</div>

<div id="error-container"></div>
<div id="success-container"></div>
{% endblock %} 