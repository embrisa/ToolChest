{# Navigation Component Library #}

{# Navbar Component - Modern navigation bar with glass morphism #}
{% macro Navbar(config = {}) %}
  {% set defaults = {
    brand: {
      text: 'tool-chest',
      href: '/',
      showLogo: true
    },
    search: {
      enabled: true,
      placeholder: 'Search toolsâ€¦',
      width: 'md',
      htmx: {
        endpoint: '/search',
        target: '#tool-grid',
        trigger: 'keyup changed delay:300ms, search'
      }
    },
    navigation: {
      items: [],
      showMobileMenu: true
    },
    style: {
      variant: 'modern',
      position: 'sticky',
      background: 'glass'
    }
  } %}
  {% set cfg = defaults | merge(config) %}

  <nav class="navbar-modern {{ 'sticky top-0' if cfg.style.position == 'sticky' else '' }} z-50" 
       data-navbar-variant="{{ cfg.style.variant }}">
    <div class="max-w-7xl mx-auto flex items-center justify-between px-6 py-4 lg:py-5">
      
      {# Brand / Logo Section #}
      <div class="flex items-center space-x-4">
        {% if cfg.brand.showLogo %}
          {% from "components/logo.njk" import logo %}
          {{ logo(size="text-2xl lg:text-3xl", href=cfg.brand.href) }}
        {% else %}
          <a href="{{ cfg.brand.href }}" class="navbar-brand text-2xl lg:text-3xl font-bold text-sand-100 hover:text-sand-200 transition-colors duration-200">
            {{ cfg.brand.text }}
          </a>
        {% endif %}
      </div>

      {# Center Navigation (Desktop) #}
      {% if cfg.navigation.items | length > 0 %}
        <div class="hidden lg:flex items-center space-x-8">
          {% for item in cfg.navigation.items %}
            <a href="{{ item.href }}" 
               class="navbar-link text-sand-200 hover:text-sand-100 transition-colors duration-200 {{ 'font-medium text-sand-100' if item.active else '' }}">
              {% if item.icon %}<i class="{{ item.icon }} mr-2"></i>{% endif %}
              {{ item.text }}
            </a>
          {% endfor %}
        </div>
      {% endif %}

      {# Right Section - Search and Actions #}
      <div class="flex items-center space-x-4">
        
        {# Search Component #}
        {% if cfg.search.enabled %}
          <div class="relative hidden md:block">
            {% set searchWidth = {
              'sm': 'w-48 focus:w-64',
              'md': 'w-64 lg:w-80 focus:w-96',
              'lg': 'w-80 lg:w-96 focus:w-[28rem]'
            }[cfg.search.width] %}
            
            <input 
              {% if cfg.search.htmx %}
              hx-get="{{ cfg.search.htmx.endpoint }}" 
              hx-target="{{ cfg.search.htmx.target }}" 
              hx-trigger="{{ cfg.search.htmx.trigger }}"
              {% endif %}
              name="q" 
              placeholder="{{ cfg.search.placeholder }}"
              class="search-input {{ searchWidth }} pl-10 pr-4 py-3 rounded-2xl text-sm transition-all duration-300"
              autocomplete="off"
            />
            <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400 text-sm"></i>
          </div>
        {% endif %}

        {# Mobile Menu Button #}
        {% if cfg.navigation.showMobileMenu %}
          <button class="lg:hidden content-container-button navbar-mobile-toggle" 
                  aria-label="Toggle mobile menu"
                  data-mobile-menu-toggle>
            <i class="fas fa-bars text-sand-300"></i>
          </button>
        {% endif %}
      </div>
    </div>

    {# Mobile Menu #}
    {% if cfg.navigation.showMobileMenu and cfg.navigation.items | length > 0 %}
      <div class="lg:hidden navbar-mobile-menu hidden border-t border-sand-300/10" data-mobile-menu>
        <div class="px-6 py-4 space-y-2">
          {% for item in cfg.navigation.items %}
            <a href="{{ item.href }}" 
               class="flex items-center px-4 py-3 rounded-xl text-sand-200 hover:text-sand-100 hover:bg-sand-300/10 transition-all duration-200 {{ 'bg-sand-300/15 text-sand-100' if item.active else '' }}">
              {% if item.icon %}<i class="{{ item.icon }} mr-3 w-5"></i>{% endif %}
              {{ item.text }}
            </a>
          {% endfor %}
          
          {# Mobile Search #}
          {% if cfg.search.enabled %}
            <div class="pt-4 border-t border-sand-300/10">
              <div class="relative">
                <input 
                  {% if cfg.search.htmx %}
                  hx-get="{{ cfg.search.htmx.endpoint }}" 
                  hx-target="{{ cfg.search.htmx.target }}" 
                  hx-trigger="{{ cfg.search.htmx.trigger }}"
                  {% endif %}
                  name="q" 
                  placeholder="{{ cfg.search.placeholder }}"
                  class="search-input w-full pl-10 pr-4 py-3 rounded-2xl text-sm"
                  autocomplete="off"
                />
                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400 text-sm"></i>
              </div>
            </div>
          {% endif %}
        </div>
      </div>
    {% endif %}
  </nav>
{% endmacro %}

{# Simple Navbar - Minimal version #}
{% macro SimpleNavbar(brand = 'tool-chest', href = '/', searchEnabled = true) %}
  {{ Navbar({
    brand: { text: brand, href: href },
    search: { enabled: searchEnabled },
    navigation: { items: [] }
  }) }}
{% endmacro %}

{# Footer Component - Complete footer with sections #}
{% macro Footer(config = {}) %}
  {% set defaults = {
    brand: {
      text: 'tool-chest',
      description: 'Utility tools for common tasks.',
      href: '/',
      showLogo: true
    },
    sections: [
      {
        title: 'Links',
        items: [
          { text: 'Privacy Policy', href: '/privacy' },
          { text: 'Terms of Service', href: '/terms' },
          { text: 'Contact', href: '/contact' }
        ]
      }
    ],
    social: {
      enabled: true,
      items: [
        { icon: 'fab fa-github', href: '#', label: 'GitHub' },
        { icon: 'fab fa-twitter', href: '#', label: 'Twitter' }
      ]
    },
    copyright: {
      enabled: true,
      text: null,
      year: null
    },
    layout: {
      columns: 'auto',
      variant: 'modern'
    }
  } %}
  {% set cfg = defaults | merge(config) %}

  <footer class="navbar-modern border-t border-sand-300/10 mt-auto" data-footer-variant="{{ cfg.layout.variant }}">
    <div class="max-w-7xl mx-auto px-6 py-12">
      
      {# Main footer content #}
      {% set totalSections = (1 if cfg.brand else 0) + (cfg.sections | length) + (1 if cfg.social.enabled else 0) %}
      {% set gridCols = {
        1: 'grid-cols-1',
        2: 'grid-cols-1 md:grid-cols-2',
        3: 'grid-cols-1 md:grid-cols-3',
        4: 'grid-cols-1 md:grid-cols-2 lg:grid-cols-4'
      }[totalSections] or 'grid-cols-1 md:grid-cols-3' %}
      
      <div class="grid {{ gridCols if cfg.layout.columns == 'auto' else cfg.layout.columns }} gap-8 mb-8">
        
        {# Brand section #}
        {% if cfg.brand %}
          <div class="text-center md:text-left">
            {% if cfg.brand.showLogo %}
              {% from "components/logo.njk" import logo %}
              <div class="mb-4">{{ logo(size="text-3xl", href=cfg.brand.href) }}</div>
            {% else %}
              <a href="{{ cfg.brand.href }}" class="footer-brand text-3xl font-bold text-sand-100 hover:text-sand-200 transition-colors duration-200 mb-4 block">
                {{ cfg.brand.text }}
              </a>
            {% endif %}
            
            {% if cfg.brand.description %}
              <p class="text-neutral-300 text-sm leading-relaxed max-w-xs">
                {{ cfg.brand.description }}
              </p>
            {% endif %}
          </div>
        {% endif %}
        
        {# Navigation sections #}
        {% for section in cfg.sections %}
          <div class="text-center {{ 'md:text-left' if loop.first else '' }}">
            <h4 class="text-sand-200 font-semibold text-sm uppercase tracking-wider mb-4">
              {{ section.title }}
            </h4>
            <div class="space-y-2">
              {% for item in section.items %}
                <a href="{{ item.href }}" 
                   class="block text-neutral-400 hover:text-sand-300 transition-colors duration-200 text-sm"
                   {% if item.external %}target="_blank" rel="noopener noreferrer"{% endif %}>
                  {% if item.icon %}<i class="{{ item.icon }} mr-2"></i>{% endif %}
                  {{ item.text }}
                  {% if item.external %}<i class="fas fa-external-link-alt ml-1 text-xs"></i>{% endif %}
                </a>
              {% endfor %}
            </div>
          </div>
        {% endfor %}
        
        {# Social/Contact section #}
        {% if cfg.social.enabled and cfg.social.items | length > 0 %}
          <div class="text-center md:text-right">
            <h4 class="text-sand-200 font-semibold text-sm uppercase tracking-wider mb-4">
              Connect
            </h4>
            <div class="flex justify-center md:justify-end space-x-4">
              {% for social in cfg.social.items %}
                <a href="{{ social.href }}" 
                   class="w-8 h-8 content-container-button flex items-center justify-center group"
                   aria-label="{{ social.label }}"
                   {% if social.external %}target="_blank" rel="noopener noreferrer"{% endif %}>
                  <i class="{{ social.icon }} text-sand-300 text-sm group-hover:text-sand-200 transition-colors duration-200"></i>
                </a>
              {% endfor %}
            </div>
          </div>
        {% endif %}
      </div>
      
      {# Copyright section #}
      {% if cfg.copyright.enabled %}
        <div class="pt-8 border-t border-sand-300/10 text-center">
          <p class="text-neutral-400 text-sm">
            {% if cfg.copyright.text %}
              {{ cfg.copyright.text }}
            {% else %}
              &copy; {{ cfg.copyright.year or (now() | date("YYYY")) }} {{ cfg.brand.text or 'tool-chest' }}. All rights reserved.
            {% endif %}
          </p>
        </div>
      {% endif %}
    </div>
  </footer>
{% endmacro %}

{# Simple Footer - Minimal version #}
{% macro SimpleFooter(brand = 'tool-chest', description = null) %}
  {{ Footer({
    brand: { text: brand, description: description },
    sections: [
      {
        title: 'Links',
        items: [
          { text: 'Privacy Policy', href: '/privacy' },
          { text: 'Terms of Service', href: '/terms' },
          { text: 'Contact', href: '/contact' }
        ]
      }
    ]
  }) }}
{% endmacro %}

{# Breadcrumb Component #}
{% macro Breadcrumb(items = [], separator = 'chevron') %}
  {% if items | length > 0 %}
    <nav class="breadcrumb-container mb-6" aria-label="Breadcrumb">
      <ol class="flex items-center space-x-2 text-sm">
        {% for item in items %}
          <li class="flex items-center">
            {% if not loop.first %}
              <span class="breadcrumb-separator text-neutral-400 mx-2">
                {% if separator == 'chevron' %}
                  <i class="fas fa-chevron-right text-xs"></i>
                {% elif separator == 'slash' %}
                  /
                {% else %}
                  {{ separator }}
                {% endif %}
              </span>
            {% endif %}
            
            {% if item.href and not loop.last %}
              <a href="{{ item.href }}" 
                 class="breadcrumb-link text-neutral-400 hover:text-sand-300 transition-colors duration-200">
                {% if item.icon %}<i class="{{ item.icon }} mr-2"></i>{% endif %}
                {{ item.text }}
              </a>
            {% else %}
              <span class="breadcrumb-current text-sand-200 font-medium">
                {% if item.icon %}<i class="{{ item.icon }} mr-2"></i>{% endif %}
                {{ item.text }}
              </span>
            {% endif %}
          </li>
        {% endfor %}
      </ol>
    </nav>
  {% endif %}
{% endmacro %}

{# Sidebar Navigation Component #}
{% macro SidebarNav(config = {}) %}
  {% set defaults = {
    title: 'Navigation',
    items: [],
    collapsed: false,
    variant: 'modern'
  } %}
  {% set cfg = defaults | merge(config) %}

  <aside class="sidebar-nav {{ 'sidebar-collapsed' if cfg.collapsed else '' }}" 
         data-sidebar-variant="{{ cfg.variant }}">
    {% if cfg.title %}
      <div class="sidebar-header p-6 border-b border-sand-300/10">
        <h3 class="text-sand-200 font-semibold text-lg">{{ cfg.title }}</h3>
      </div>
    {% endif %}
    
    <nav class="sidebar-content p-6">
      <ul class="space-y-2">
        {% for item in cfg.items %}
          <li>
            {% if item.children %}
              {# Collapsible menu item #}
              <div class="sidebar-group">
                <button class="sidebar-group-toggle w-full text-left" data-toggle-group="{{ loop.index }}">
                  <span class="admin-nav-item-modern w-full justify-between">
                    <span class="flex items-center">
                      {% if item.icon %}<i class="{{ item.icon }} mr-3 w-5"></i>{% endif %}
                      {{ item.text }}
                    </span>
                    <i class="fas fa-chevron-down transition-transform duration-200"></i>
                  </span>
                </button>
                <ul class="sidebar-submenu mt-2 ml-8 space-y-1 {{ 'hidden' if not item.expanded else '' }}" 
                    data-group="{{ loop.index }}">
                  {% for child in item.children %}
                    <li>
                      <a href="{{ child.href }}" 
                         class="block px-4 py-2 text-sm text-neutral-400 hover:text-sand-300 rounded-lg hover:bg-sand-300/10 transition-all duration-200 {{ 'text-sand-200 bg-sand-300/15' if child.active else '' }}">
                        {% if child.icon %}<i class="{{ child.icon }} mr-2"></i>{% endif %}
                        {{ child.text }}
                      </a>
                    </li>
                  {% endfor %}
                </ul>
              </div>
            {% else %}
              {# Regular menu item #}
              <a href="{{ item.href }}" 
                 class="admin-nav-item-modern block {{ 'active' if item.active else '' }}">
                {% if item.icon %}<i class="{{ item.icon }} mr-3 w-5"></i>{% endif %}
                {{ item.text }}
                {% if item.badge %}
                  <span class="ml-auto px-2 py-1 text-xs rounded-full bg-sand-300/20 text-sand-200">
                    {{ item.badge }}
                  </span>
                {% endif %}
              </a>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    </nav>
  </aside>
{% endmacro %} 