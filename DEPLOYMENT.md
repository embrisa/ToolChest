# tool-chest Deployment Guide

## Railway Deployment

This guide covers deploying tool-chest to Railway using Docker.

### Prerequisites

1. Railway account ([railway.app](https://railway.app))
2. GitHub repository connected to Railway
3. Docker configured properly (included in this repo)

### Quick Deploy

[![Deploy on Railway](https://railway.app/button.svg)](https://railway.app/new/template)

### Manual Deployment Steps

#### 1. Create New Railway Project

```bash
# Install Railway CLI
npm install -g @railway/cli

# Login to Railway
railway login

# Create new project
railway new
```

#### 2. Add PostgreSQL Database

1. In Railway dashboard, click "New" → "Database" → "PostgreSQL"
2. Railway will automatically generate a `DATABASE_URL` environment variable

#### 3. Configure Environment Variables

Set these in Railway dashboard under "Variables":

```bash
# Required
DATABASE_URL=postgresql://...  # Auto-generated by Railway
ADMIN_SECRET_TOKEN=your-secure-admin-token-here

# Optional
NEXT_PUBLIC_SITE_URL=https://your-app.railway.app
NEXT_PUBLIC_GA_ID=G-XXXXXXXXXX
NODE_ENV=production
```

#### 4. Deploy the Application

Railway will automatically:

- Detect the `Dockerfile`
- Build the Docker image
- Run database migrations
- Deploy the application

If you choose Railway's Node environment instead of Docker, make sure to
apply migrations with `npm run db:deploy` before starting the server.

### Environment Variables Reference

| Variable               | Required | Description                   | Example                               |
| ---------------------- | -------- | ----------------------------- | ------------------------------------- |
| `DATABASE_URL`         | ✅       | PostgreSQL connection string  | `postgresql://user:pass@host:5432/db` |
| `ADMIN_SECRET_TOKEN`   | ✅       | Secret token for admin access | `your-super-secure-token-123`         |
| `NEXT_PUBLIC_SITE_URL` | ❌       | Your site URL for SEO         | `https://tool-chest.railway.app`      |
| `NEXT_PUBLIC_GA_ID`    | ❌       | Google Analytics ID           | `G-XXXXXXXXXX`                        |
| `NODE_ENV`             | ❌       | Node environment              | `production`                          |

### Post-Deployment Steps

#### 1. Verify Health Check

```bash
curl https://your-app.railway.app/api/health
```

Expected response:

```json
{
  "status": "healthy",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "database": "connected",
  "version": "1.0.0"
}
```

#### 2. Access Admin Panel

1. Visit: `https://your-app.railway.app/admin`
2. Enter your `ADMIN_SECRET_TOKEN`
3. Verify dashboard loads correctly

#### 3. Test Core Tools

- Base64 Tool: `https://your-app.railway.app/tools/base64`
- Hash Generator: `https://your-app.railway.app/tools/hash-generator`
- Favicon Generator: `https://your-app.railway.app/tools/favicon-generator`
- Markdown to PDF: `https://your-app.railway.app/tools/markdown-to-pdf`

### Monitoring & Maintenance

#### Health Monitoring

Railway automatically monitors the `/api/health` endpoint. The application will restart if health checks fail.

#### Database Backups

Railway PostgreSQL includes automatic backups. Access them in the Railway dashboard.

#### Logs

View application logs in Railway dashboard:

```bash
# Or via CLI
railway logs
```

#### Updates

Railway will automatically redeploy when you push to your connected Git repository.

### Custom Domain (Optional)

1. In Railway dashboard, go to your service
2. Click "Settings" → "Domains"
3. Add your custom domain
4. Update DNS records as instructed
5. Update `NEXT_PUBLIC_SITE_URL` environment variable

### Troubleshooting

#### Common Issues

1. **Database Connection Failed**

   - Verify `DATABASE_URL` is set correctly
   - Check Railway PostgreSQL service is running

2. **Build Failures**

   - Check build logs in Railway dashboard
   - Verify all dependencies are in `package.json`

3. **Health Check Failures**

   - Verify application starts without errors
   - Check database connectivity

4. **Admin Access Issues**
   - Verify `ADMIN_SECRET_TOKEN` is set
   - Clear browser cookies and try again

#### Debug Commands

```bash
# Check environment variables
railway variables

# View build logs
railway logs --build

# View runtime logs
railway logs

# Connect to database
railway connect postgresql
```

### Security Considerations

1. **Admin Token**: Use a strong, unique token for `ADMIN_SECRET_TOKEN`
2. **Environment Variables**: Never commit sensitive variables to Git
3. **HTTPS**: Railway provides HTTPS by default
4. **Database**: Railway PostgreSQL is secured by default

### Performance Optimization

1. **CDN**: Railway includes CDN for static assets
2. **Caching**: Application includes optimized caching headers
3. **Image Optimization**: Next.js optimizes images automatically
4. **Database**: Use Railway's connection pooling for better performance

### Support

- Railway Documentation: [docs.railway.app](https://docs.railway.app)
- Railway Discord: [discord.gg/railway](https://discord.gg/railway)
- Project Issues: GitHub Issues tab
